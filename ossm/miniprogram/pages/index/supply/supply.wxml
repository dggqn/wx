<!--pages/index/supply/supply.wxml-->
<view class="container flex-column">
	<!-- 上部 -->
	<view class="supply-top">
		<view class="top-tabs flex-align-items-center">
			<view class="tabs flex-1 flex">
				<view data-tab='assets' class="tab {{tab==='assets'?'active':''}}" bindtap="changeTab">
					<text>我的资产</text>
					<text wx:if="{{tab==='assets'}}" class="bottom-line"></text>
				</view>
				<view data-tab='consume' class="tab {{tab==='consume'?'active':''}}" bindtap="changeTab">
					<text>我的耗材</text>
					<text wx:if="{{tab==='consume'}}" class="bottom-line"></text>
				</view>
				<view data-tab='sector-assets' class="tab {{tab==='sector-assets'?'active':''}}" bindtap="changeTab" wx:if="{{isDeptManager}}">
					<text>部门资产</text>
					<text wx:if="{{tab==='sector-assets'}}" class="bottom-line"></text>
				</view>
				<view data-tab='sector-consume' class="tab {{tab==='sector-consume'?'active':''}}" bindtap="changeTab" wx:if="{{isDeptManager}}">
					<text>部门耗材</text>
					<text wx:if="{{tab==='sector-consume'}}" class="bottom-line"></text>
				</view>
			</view>
			<!-- <navigator class="use-record" url="/pages/collarRecords/collarRecords">
				<text class="iconfont iconlingyongjilu-icon-01"></text>
				<text>领用记录</text>
			</navigator> -->
			
		</view>
		<view class="top-search flex-align-items-center">
			<input class="search-ipt flex-1" placeholder="请输入物品名称或编号" bindinput="inputKeyword" bindblur="search" placeholder-class="placeholder-style">
			<text class="iconfont iconsousuo-icon-01" bindtap="search"></text>
			</input>
			<navigator class="use-record" url="/pages/assetsRecordFolder/assetsRecord/assetsRecord" style="margin-left:20rpx">
				<text class="iconfont iconlingyongjilu-icon-01"></text>
				<text>资产记录</text>
			</navigator>
		</view>
	</view>
	<!-- 排序方式 -->
	<view class="supply-order"  wx:if="{{tab==='assets' || tab === 'sector-assets'}}">
		<!-- <text>默认排序</text> -->
		<!-- <text class="iconfont iconshuangyoujiantoufuzhi-01"></text> -->
		<!-- <view class="flex-1"></view> -->
    <van-dropdown-menu class="sort-dropdown">
        <van-dropdown-item value='' options="{{assetsSortOption}}" bind:change="sort"/>
    </van-dropdown-menu>
	</view>
	<!-- 物资列表 -->
	<view class="flex-1 public-list-box" wx:if="{{tab==='assets'|| tab === 'sector-assets'}}">
		<view class="public-list" wx:if="{{assetsList.length>0}}">
			<!-- 我的资产 -->
			<view class="list-item flex" wx:for="{{assetsList}}" wx:key="entityId">
				<view class="{{item.assetsStatus === 'in_use'?'in-use':'change'}} item-status">{{item.dict.assetsStatus_dictText}}</view>


				<view
					  class="select-box-l flex-align-items-center"
					  data-index="{{index}}"
					  wx:if="{{!item.selectable}}"
				>
					<view class="disable"></view>
				</view>
				<view
					class="select-box-l flex-align-items-center"
					data-index="{{index}}"
					bindtap="selected"
					wx:else
				>
					<text class="iconfont {{assetsList[index].isSelected?'icongou':'iconweixuan'}}"></text>
				</view>


				<view class="item-img img-box" 	data-snno="{{item.snNo}}" bindtap="jumpDetails">
					<image class="img" mode="aspectFit" src="{{item.displayImgUrl?item.displayImgUrl:aliyunBaseImgUrlPre+'images/default.png'}}"></image>
				</view>

				<view class="item-detail flex-1 flex-column" data-snno="{{item.assetsNo}}" bindtap="jumpDetails">
					<view class="detail-top">
						<view class="detail-name ellipsis-two">{{item.name}}</view>
						<view class="detail-num">
							<text>资产ID </text>
							<text>{{item.assetsNo}}</text>
						</view>
					</view>
					<view class="detail-bottom">
						<!-- <view class="detail-sign-date">签收日期：{{item.signDate}}</view> -->
						<view class="detail-bottom-item flex">
							<view class="specifications">规格：</view>
							<view class="ellipsis-one">{{item.specificationName}}</view>
						</view>
						<view class="detail-bottom-item">
							<text>单位：</text>
							<text>{{item.stockUnit}}</text>
						</view>
					</view>
				</view>
				<view class="select-box-r flex-align-items-center"><text class="iconfont iconyoujiantou-new-01"></text></view>

			</view>
			<!-- 变更	报废 按钮 -->
				<view class="operation flex-between-center">
					<view class="flex-align-items-center">
						<text class="iconfont {{chooseAll?'icongou':'iconweixuan'}}" bindtap="chooseAll"></text>
						<text>已选 {{selectedNum}}</text>
					</view>
					<view class="operation-btn-box flex">
						<button class="btn" data-type="change" disabled="{{selectedNum === 0}}" bindtap="changeTo">变更</button>
						<button class="btn blue" data-type="scrap" disabled="{{selectedNum === 0}}" bindtap="changeTo">报废</button>
					</view>
				</view>
			
			<view class="removeFixed"></view>
      <!-- <van-empty image="search" description="暂无资产" wx:if="{{assetsList.length<=0}}"/> -->
		</view>
		<view class="empty-box" wx:if="{{assetsList.length<=0}}">
				<image class="empty-img" src="{{aliyunBaseImgUrlPre}}images/empty.png"></image>
				<view class="empty-tip">暂无资产</view>
			</view>
	</view>

	<!-- 我的耗材 -->
	<view class="flex-1 public-list-box" wx:if="{{tab==='consume' || tab==='sector-consume'}}">
		<view class="public-list" wx:if="{{consumableList.length > 0}}">
     	<!-- <van-empty image="search" description="暂无耗材" wx:if="{{consumableList.length<=0}}"/> -->
			<view class="list-item flex" wx:for="{{consumableList}}"  wx:key="entityId">
				<view class="item-img img-box">
					<image class="img" mode="aspectFit" src="{{item.displayImgUrl?item.displayImgUrl:aliyunBaseImgUrlPre+'images/default.png'}}"></image>
				</view>
				<!-- 我的耗材 -->
				<view class="item-detail flex-1 flex-column">
					<view class="detail-top">
						<view class="detail-name">{{item.name}}</view>
						<view class="detail-num">
							<text wx:if="{{tab==='consume'}}">耗材编号 </text>
							<text>{{item.modelNo}}</text>
						</view>
					</view>
					<view class="detail-bottom" wx:if="{{tab==='consume' || tab==='sector-consume'}}">
            <view class="detail-check-person">累计领用：{{item.quantity}}</view>
            <view class="detail-sign-date">最近领用：{{item.lastedReceiveDate}}</view>
          </view>
				</view>
			</view>
		</view>
		<view class="empty-box" wx:if="{{consumableList.length<=0}}">
				<image class="empty-img" src="{{aliyunBaseImgUrlPre}}images/empty.png"></image>
				<view class="empty-tip">暂无耗材</view>
			</view>
	</view>
</view>
